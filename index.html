<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>52Rent — Оренда автомобілів</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <style>
        .main-nav {
            display: flex;
            gap: 30px;
            align-items: center;
        }
        
        #auth-buttons, #user-menu {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .hidden {
            display: none !important;
        }
        
        .feature-icon {
            font-size: 3rem;
            color: #ff9900;
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">52Rent</a>
                
                <nav class="main-nav">
                    <a href="index.html" class="nav-link active">Головна</a>
                    <a href="rent.html" class="nav-link">Прокат авто</a>
                    <a href="business.html" class="nav-link">Для бізнесу</a>
                    <a href="bookings.html" class="nav-link">Мої бронювання</a>
                    
                    <div id="auth-buttons" class="user-menu">
                        <a href="login.html" class="btn btn-outline">Увійти</a>
                    </div>
                    
                        <div id="user-menu" class="user-menu hidden">
                        <div class="notification-badge" id="notification-badge">
                            <i class="fas fa-bell"></i>
                            <span class="notification-count" id="notification-count">0</span>
                            <div class="notifications-dropdown" id="notifications-dropdown" style="display: none;">
                                <div class="notification-item unread">
                                    <p>Ваше бронювання підтверджено!</p>
                                    <span class="notification-time">5 хв тому</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="user-avatar" id="user-avatar">U</div>
                        <div class="user-info">
                            <span class="user-name" id="user-name">Користувач</span>
                            <span class="user-email" id="user-email">user@example.com</span>
                        </div>
                        <button class="btn btn-outline" id="logout-btn">Вийти</button>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <h1>Оренда авто у Києві</h1>
            <p>Якісний сервіс. Надійні авто. Чесні ціни.</p>
            <a href="rent.html" class="btn btn-primary btn-lg" style="padding: 15px 30px; font-size: 18px;">Обрати авто</a>
        </div>
    </section>

    <section class="section">
        <div class="container">
            <h2 class="section-title">Наші переваги</h2>
            <div class="categories-grid">
                <div class="card">
                    <div class="card-body p-20 text-center">
                        <i class="fas fa-bolt feature-icon"></i>
                        <h3>Швидке оформлення</h3>
                        <p>Всього 5 хвилин — і авто у вас.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body p-20 text-center">
                        <i class="fas fa-shield-alt feature-icon"></i>
                        <h3>Страхування включене</h3>
                        <p>Повне КАСКО та цивілка.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body p-20 text-center">
                        <i class="fas fa-handshake feature-icon"></i>
                        <h3>Чесні ціни</h3>
                        <p>Без прихованих платежів.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body p-20 text-center">
                        <i class="fas fa-headset feature-icon"></i>
                        <h3>Підтримка 24/7</h3>
                        <p>Наша служба підтримки завжди на зв'язку.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section" style="background: #f6f6f6;">
        <div class="container">
            <h2 class="section-title">Категорії авто</h2>
            <div class="categories-grid">
                <div class="card">
                    <img src="https://images.unsplash.com/photo-1549399542-7e3f8b79c341?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" 
                         alt="Економ" class="car-image">
                    <div class="car-info">
                        <h3 class="car-title">Економ</h3>
                        <p>Від 500 грн/доба</p>
                        <a href="rent.html?category=economy" class="btn btn-outline w-100 mt-20">Переглянути</a>
                    </div>
                </div>
                <div class="card">
                    <img src="https://images.unsplash.com/photo-1553440569-bcc63803a83d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" 
                         alt="Комфорт" class="car-image">
                    <div class="car-info">
                        <h3 class="car-title">Комфорт</h3>
                        <p>Від 1200 грн/доба</p>
                        <a href="rent.html?category=comfort" class="btn btn-outline w-100 mt-20">Переглянути</a>
                    </div>
                </div>
                <div class="card">
                    <img src="https://images.unsplash.com/photo-1555212697-194d092e3b8f?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" 
                         alt="Бізнес" class="car-image">
                    <div class="car-info">
                        <h3 class="car-title">Бізнес</h3>
                        <p>Від 2500 грн/доба</p>
                        <a href="rent.html?category=business" class="btn btn-outline w-100 mt-20">Переглянути</a>
                    </div>
                </div>
                <div class="card">
                    <img src="https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" 
                         alt="SUV" class="car-image">
                    <div class="car-info">
                        <h3 class="car-title">SUV</h3>
                        <p>Від 2000 грн/доба</p>
                        <a href="rent.html?category=suv" class="btn btn-outline w-100 mt-20">Переглянути</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container">
            <h2 class="section-title">Популярні авто</h2>
            <div id="popular-cars" class="cars-grid">
                <div class="text-center w-100">
                    <p>Завантаження автомобілів...</p>
                </div>
            </div>
        </div>
    </section>

    <section class="section" style="background: #111; color: white;">
        <div class="container">
            <h2 class="section-title">Контакти</h2>
            <div class="categories-grid">
                <div class="text-center">
                    <i class="fas fa-phone fa-3x mb-20"></i>
                    <h3>Телефон</h3>
                    <p>+38 (067) 123 45 67</p>
                </div>
                <div class="text-center">
                    <i class="fas fa-envelope fa-3x mb-20"></i>
                    <h3>Email</h3>
                    <p>info@52rent.com</p>
                </div>
                <div class="text-center">
                    <i class="fas fa-clock fa-3x mb-20"></i>
                    <h3>Графік роботи</h3>
                    <p>09:00 – 21:00, без вихідних</p>
                </div>
                <div class="text-center">
                    <i class="fas fa-map-marker-alt fa-3x mb-20"></i>
                    <h3>Адреса</h3>
                    <p>м. Київ, вул. Хрещатик, 1</p>
                </div>
            </div>
        </div>
    </section>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>52Rent</h3>
                    <p>Лідер на ринку оренди автомобілів в Україні. Надійність та якість з 2015 року.</p>
                </div>
                <div class="footer-section">
                    <h3>Навігація</h3>
                    <a href="index.html">Головна</a>
                    <a href="rent.html">Прокат авто</a>
                    <a href="business.html">Для бізнесу</a>
                    <a href="bookings.html">Мої бронювання</a>
                </div>
                <div class="footer-section">
                    <h3>Контакти</h3>
                    <a href="tel:+380671234567">+38 (067) 123 45 67</a>
                    <a href="mailto:info@52rent.com">info@52rent.com</a>
                    <p>Київ, вул. Хрещатик, 1</p>
                </div>
                <div class="footer-section">
                    <h3>Соціальні мережі</h3>
                    <div class="flex gap-10">
                        <a href="#"><i class="fab fa-facebook fa-2x"></i></a>
                        <a href="#"><i class="fab fa-instagram fa-2x"></i></a>
                        <a href="#"><i class="fab fa-telegram fa-2x"></i></a>
                        <a href="#"><i class="fab fa-twitter fa-2x"></i></a>
                    </div>
                </div>
            </div>
            <div id="map" style="width: 100%; height: 400px; border-radius: 12px;"></div>
            <div class="footer-bottom">
                <p>52Rent © 2025 — Оренда автомобілів. Всі права захищені.</p>
            </div>
        </div>
    </footer>

    <div id="booking-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="close-booking-modal">&times;</button>
            <h2>Бронювання авто</h2>
            <form id="booking-form">
                <div class="form-group">
                    <label class="form-label" for="car-name-modal">Автомобіль</label>
                    <input type="text" id="car-name-modal" class="form-input" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label" for="booking-start-date">Дата початку</label>
                    <input type="date" id="booking-start-date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="booking-end-date">Дата завершення</label>
                    <input type="date" id="booking-end-date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="total-price">Загальна вартість</label>
                    <input type="text" id="total-price" class="form-input" readonly>
                </div>
                <button type="submit" class="btn btn-primary w-100">Перейти до оплати</button>
            </form>
        </div>
    </div>

    <script src="api-client.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Page loaded, initializing...');
            
            const authButtons = document.getElementById('auth-buttons');
            const userMenu = document.getElementById('user-menu');
            const logoutBtn = document.getElementById('logout-btn');
            const notificationBadge = document.getElementById('notification-badge');
            const notificationsDropdown = document.getElementById('notifications-dropdown');
            
            if (apiClient.isAuthenticated()) {
                console.log('User is authenticated');
                if (authButtons) authButtons.classList.add('hidden');
                if (userMenu) userMenu.classList.remove('hidden');
                
                apiClient.getCurrentUser().then(user => {
                    if (user) {
                        const userAvatar = document.getElementById('user-avatar');
                        const userName = document.getElementById('user-name');
                        const userEmail = document.getElementById('user-email');
                        
                        if (userAvatar && user.username) {
                            userAvatar.textContent = user.username.charAt(0).toUpperCase();
                        }
                        if (userName) {
                            userName.textContent = user.username || 'Користувач';
                        }
                        if (userEmail && user.email) {
                            userEmail.textContent = user.email;
                        }
                    }
                }).catch(console.error);
            } else {
                console.log('User is not authenticated');
                if (authButtons) authButtons.classList.remove('hidden');
                if (userMenu) userMenu.classList.add('hidden');
            }
            
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    apiClient.logout();
                    window.location.href = 'index.html';
                });
            }
            
            if (notificationBadge && notificationsDropdown) {
                notificationBadge.addEventListener('click', function(e) {
                    e.stopPropagation();
                    notificationsDropdown.style.display = 
                        notificationsDropdown.style.display === 'block' ? 'none' : 'block';
                });
                
                document.addEventListener('click', function() {
                    notificationsDropdown.style.display = 'none';
                });
            }
            
            loadPopularCars();
        });
        
        async function loadPopularCars() {
            try {
                const container = document.getElementById('popular-cars');
                if (!container) return;
                
                let cars = [];
                try {
                    const response = await apiClient.getCars({ limit: 6 });
                    cars = response.results || response.slice(0, 6) || [];
                } catch (error) {
                    console.warn('API недоступне, використовуються демо-дані');
                    cars = getDemoCars();
                }
                
                if (cars.length === 0) {
                    container.innerHTML = '<div class="text-center w-100"><p>Автомобілі не знайдено</p></div>';
                    return;
                }
                
                container.innerHTML = cars.map(car => `
                    <div class="car-card">
                        <img src="${car.image_url || 'https://images.unsplash.com/photo-1503376780353-7e6692767b70?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'}" 
                             alt="${car.brand || ''} ${car.model || ''}" class="car-image">
                        <div class="car-info">
                            <h3 class="car-title">${car.brand || ''} ${car.model || ''}</h3>
                            <div class="car-details">
                                <span class="car-detail">${car.year || '—'}</span>
                                <span class="car-detail">${car.transmission === 'automatic' ? 'Автомат' : 'Механіка'}</span>
                                <span class="car-detail">${car.fuel_type || 'Бензин'}</span>
                            </div>
                            <div class="car-price">
                                ${car.price_per_day ? `${car.price_per_day} грн/доба` : 'Ціна не вказана'}
                            </div>
                            <div class="flex gap-10 mt-20">
                                <a href="car_detail.html?id=${car.id}" class="btn btn-outline flex-1">Детальніше</a>
                                <button class="btn btn-primary flex-1" onclick="openBookingModal(${car.id})">
                                    Забронювати
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
            } catch (error) {
                console.error('Error loading cars:', error);
            }
        }
        
        function getDemoCars() {
            return [
                {
                    id: 1,
                    brand: 'Toyota',
                    model: 'Camry',
                    year: 2022,
                    transmission: 'automatic',
                    fuel_type: 'Бензин',
                    price_per_day: 1700,
                    image_url: 'https://images.unsplash.com/photo-1503376780353-7e6692767b70'
                },
                {
                    id: 2,
                    brand: 'Tesla',
                    model: 'Model 3',
                    year: 2023,
                    transmission: 'automatic',
                    fuel_type: 'Електро',
                    price_per_day: 3000,
                    image_url: 'https://images.unsplash.com/photo-1560958089-b8a1929cea89'
                },
                {
                    id: 3,
                    brand: 'BMW',
                    model: 'X5',
                    year: 2021,
                    transmission: 'automatic',
                    fuel_type: 'Дизель',
                    price_per_day: 2800,
                    image_url: 'https://images.unsplash.com/photo-1609184166822-bd1f1b991a06'
                }
            ];
        }
        
        function openBookingModal(carId) {
            const modal = document.getElementById('booking-modal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        document.getElementById('close-booking-modal')?.addEventListener('click', function() {
            document.getElementById('booking-modal').style.display = 'none';
        });
        
        window.onclick = function(event) {
            const modal = document.getElementById('booking-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };
    </script>
</body>
<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAw7BZLiy4SDXmveWC6tXEkiaP2b6JNiVU&callback=initMap"
  async
  defer
></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const address = "Київ, Хрещатик 1";

  const map = L.map("map").setView([50.4501, 30.5234], 13);

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: "© OpenStreetMap",
  }).addTo(map);

  fetch(
    "https://nominatim.openstreetmap.org/search?" +
      new URLSearchParams({
        q: address,
        format: "json",
        limit: 1,
      })
  )
    .then((res) => res.json())
    .then((data) => {
      if (!data.length) return;

      const lat = data[0].lat;
      const lon = data[0].lon;

      map.setView([lat, lon], 16);

      L.marker([lat, lon])
        .addTo(map)
        .bindPopup("52Rent<br>Київ, Хрещатик 1")
        .openPopup();
    });
</script>
</html>
